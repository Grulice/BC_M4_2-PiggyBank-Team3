!function(e){var n={};function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(n){return e[n]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){var r=t(1),i=t(2),o=document.querySelector(".plan-container"),c=document.querySelector(".pop-up");function a(){var e,n,t,r;document.querySelector(".blur").classList.remove("hidden"),e=".pop-up",n="bounceInDown",(r=document.querySelector(e)).classList.add("animated",n),r.classList.add("faster",n),r.addEventListener("animationend",(function e(){r.classList.remove("animated",n),r.removeEventListener("animationend",e),"function"==typeof t&&t()})),c.classList.remove("hidden")}function u(e){(e.target.parentElement.remove(),2===o.childElementCount)&&document.querySelector(".piggy-boom").classList.remove("hidden")}function l(e){var n,t,r,i=e.target.closest(".plan");t={description:d,initSum:f,term:p,desiredSum:s},r={description:(n=i).querySelector(".info-description"),initSum:n.querySelector(".info-initsum"),finalSum:n.querySelector(".info-finalsum"),term:n.querySelector(".info-term"),prodname:n.querySelector(".info-prodname"),interestRate:n.querySelector(".info-interestrate"),depSum:n.querySelector(".info-depsum")},t.description.value=r.description.innerText,t.initSum.value=r.initSum.innerText,t.term.value=r.term.innerText,t.desiredSum.value=r.finalSum.innerText,y=!0,m=n,a(),console.log(i)}document.querySelector("#coin").addEventListener("click",(function(e){return setTimeout(a,5e3)})),document.getElementById("add").addEventListener("click",a);var m,d=document.querySelector("#item-name"),s=document.querySelector("#final-amount"),p=document.querySelector("#time"),f=document.querySelector("#deposit"),v=document.querySelector("#error-caption"),y=!1,S={depositName:document.getElementById("deposit-name-caption"),percent:document.getElementById("percent-caption"),monthlyDeposit:document.getElementById("monthly-deposit-caption")},h=document.querySelector(".pig-wait"),g=document.querySelector(".offer"),x=document.querySelector(".calc-div button"),T=document.querySelector(".close span");x.addEventListener("click",(function(){var e={description:d.value,initSum:Number(f.value),term:Number(p.value),desiredSum:Number(s.value)};v.innerText="",L.classList.remove("hidden"),r.getDeposits().then((function(n){return console.log(i.getAlternativeProduct(n,e)),i.getBestProduct(n,e)})).then((function(e){"string"!=typeof e?(console.log(e),S.depositName.innerText="Вклад: "+e.deposit,S.percent.innerText="Годовая ставка: "+e.income+"%",S.monthlyDeposit.innerText="Ежемесячное пополнение: "+e.monthlyDeposit.toFixed(2),E.classList.remove("hidden"),function(e,n){var t=document.getElementById(e),r=n.monthlyInfo,i=n.monthlyDeposit,o=n.income;M(e);for(var c=0;c<r.length;c++){var a=r[c],u=t.insertRow(-1),l=u.insertCell(0),m=u.insertCell(1),d=u.insertCell(2),s=u.insertCell(3),p=u.insertCell(4),f=u.insertCell(5);l.innerHTML=c+1,m.innerHTML=a.startBalance.toFixed(2),d.innerHTML=i.toFixed(2),s.innerHTML=o+"%",p.innerHTML=a.monthlyInterest.toFixed(2),f.innerHTML=a.endBalance.toFixed(2)}}("info-table",e),b=e,h.style.display="none",g.style.display="flex"):v.innerText="Не найдено ни одного варианта по данным параметрам"})).catch((function(e){console.error("Failed to fetch data from API: "+e),alert("Произошла ошибка подключения к серверу")})).finally((function(e){L.classList.add("hidden")}))})),T.addEventListener("click",q),document.getElementById("button-confirm").addEventListener("click",(function(){if(y){var e={description:d.value,initSum:Number(f.value),term:Number(p.value),desiredSum:Number(s.value)},n={description:e.description,initSum:e.initSum,finalSum:b.sum,term:b.userTerm,prodname:b.deposit,interestRate:b.income,depSum:b.monthlyDeposit.toFixed(2)};r=n,(i={description:(t=m).querySelector(".info-description"),initSum:t.querySelector(".info-initsum"),finalSum:t.querySelector(".info-finalsum"),term:t.querySelector(".info-term"),prodname:t.querySelector(".info-prodname"),interestRate:t.querySelector(".info-interestrate"),depSum:t.querySelector(".info-depsum")}).description.innerText=r.description,i.initSum.innerText=r.initSum,i.finalSum.innerText=r.finalSum,i.term.innerText=r.term,i.prodname.innerText=r.prodname,i.interestRate.innerText=r.interestRate,i.depSum.innerText=r.depSum,y=!1}else!function(e,n,t,r,i,c,a){var m=document.createElement("div");m.className="plan";var d=document.createElement("div");d.className="edit mini-button";var s=document.createElement("div");s.className="delete mini-button",s.innerText="X";var p=document.createElement("div");p.classList.add("content-main-focus"),p.innerHTML='<span class="info-description">'.concat(e,"</span>");var f=document.createElement("div");f.classList.add("content-description");var v=document.createElement("div");v.classList.add("content-left-description");var y=document.createElement("p");y.innerHTML='Начальный вклад: <span class="info-initsum">'.concat(n,"</span> RUB");var S=document.createElement("p");S.innerHTML='Целевая сумма: <span class="info-finalsum">'.concat(t,"</span> RUB");var h=document.createElement("p");h.innerHTML='Срок вклада: <span class="info-term">'.concat(r,"</span> месяцев");var g=document.createElement("div");g.classList.add("content-right-description");var x=document.createElement("p");x.innerHTML='Описание: <span class="info-prodname">'.concat(i,"</span>");var T=document.createElement("p");T.innerHTML='Процентная ставка: <span class="info-interestrate">'.concat(c,"</span>%");var L=document.createElement("p");L.innerHTML='Ежемесячное пополнение: <span class="info-depsum">'.concat(a,"</span>"),m.append(d,s),o.append(m),d.addEventListener("click",l),s.addEventListener("click",u),m.append(p,f),f.append(v,g),v.append(y,S,h),g.append(x,T,L)}(d.value,Number(f.value),b.sum,b.userTerm,b.deposit,b.income,b.monthlyDeposit.toFixed(2));var t,r,i;document.querySelector(".piggy-boom").classList.add("hidden"),q()})),document.getElementById("button-cancel").addEventListener("click",B);var L=document.getElementById("loading-icon");var b={},E=document.querySelector(".table-container");function q(){document.querySelector(".pop-up").classList.add("hidden"),document.querySelector(".blur").classList.add("hidden"),B()}function B(){d.value="",s.value="",p.value="",f.value="",h.style.display="block",g.style.display="none",v.innerText="",E.classList.add("hidden"),M("info-table")}function M(e){for(var n=document.getElementById(e),t=n.rows.length;--t;)n.deleteRow(t)}document.querySelector("#xls-download-btn").addEventListener("click",(function(){!function(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r="application/vnd.ms-excel",i=document.getElementById(e),o=i.outerHTML.replace(/ /g,"%20");if(t=t?t+".xls":"excel_data.xls",n=document.createElement("a"),document.body.appendChild(n),navigator.msSaveOrOpenBlob){var c=new Blob(["\ufeff",o],{type:r});navigator.msSaveOrOpenBlob(c,t)}else n.href="data:"+r+", "+o,n.download=t,n.click()}("info-table","piggy_depositBreakDown")}))},function(e,n){var t=-1,r=[];e.exports={getDeposits:function(){if(Date.now()-t>6e4||-1===t){return fetch("https://bolta.herokuapp.com/deposits").then((function(e){return e.json()})).then((function(e){return t=Date.now(),r=e,e}))}return Promise.resolve(r)}}},function(e,n){var t=function(e,n){return e.filter((function(e){return e.minSumm<=n.initSum&&(e.maxSumm>=n.initSum||""===e.maxSumm)})).filter((function(e){return e.minTerm<=n.term&&e.maxTerm>=n.term}))},r=function(e){var n=[];if(e.length>1){var t=e.sort((function(e,n){return n.income-e.income}));return n.push(t[0]),n}return 1==e.length?(n.push(e[0]),n):"По вашим параметрам вкладов не найдено"},i=function(e,n){for(var t=n.initSum,r=o(n.initSum,n.desiredSum,n.term,e.income/100/12),i=[],c=0;c<n.term;c++){var a={};a.startBalance=t,a.monthlyInterest=t*(e.income/100/12),t=t*(1+e.income/100/12)+r,a.endBalance=t,i.push(a)}return{deposit:e.deposit,income:e.income,sum:Math.ceil(t),userTerm:n.term,minTerm:e.minTerm,monthlyDeposit:r,monthlyInfo:i}},o=function(e,n,t,r){var i=(n-e*Math.pow(1+r,t))*r/(Math.pow(1+r,t)-1);return i<0?0:i},c=function(e,n){var t,r,i=e.filter((function(e){return e.minSumm<=n.initSum+5e4&&(e.maxSumm>=n.initSum+5e4||""===e.maxSumm)}));i.length>1&&(t=i.sort((function(e,n){return n.income-e.income})));var o=e.filter((function(e){return e.minTerm<=n.term+3&&e.maxTerm>=n.term+3}));return o.length>1&&(r=o.sort((function(e,n){return n.income-e.income}))),[t[0],r[0]]};e.exports={getBestProduct:function(e,n){var o=t(e,n),c=r(o);return"string"==typeof c?"Sorry we can't find appropriate product":i(c[0],n)},getAlternativeProduct:function(e,n){var t=c(e,n),r=[];if(t.length>1&&null!=t.length){var o=i(t[0],n);r.push(o);var a=i(t[1],n);return r.push(a),r}if(1==t.length&&null!=t.length){var u=i(t[0],n);return r.push(u),r}if(null==t.length||0==t.length)return"Sorry we can't find appropriate product"}}}]);